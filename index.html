<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Reading Mode Experiment</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: auto;
    padding: 20px;
    line-height: 1.7;
    transition: background 0.3s, color 0.3s;
  }
  .dark { background: #121212; color: #e0e0e0; }
  .section { display: none; }
  .visible { display: block; }
  .timer { font-size: 1.6rem; font-weight: bold; margin: 20px 0; }
  button {
    padding: 12px 20px;
    font-size: 17px;
    cursor: pointer;
    margin-top: 20px;
  }
  textarea {
    width: 100%;
    height: 90px;
    padding: 10px;
    font-size: 16px;
  }
  .result-box {
    padding: 15px;
    border-radius: 8px;
    background: #f2f2f2;
  }
  .dark .result-box { background: #1f1f1f; }
</style>
</head>
<body>

<!-- START PAGE -->
<div id="startPage" class="section visible">
  <h1>Reading Time Study</h1>
  <p>You will read two passages in random order and random color mode.</p>
  <button id="beginBtn">Start</button>
</div>

<!-- PASSAGE 1 -->
<div id="passage1" class="section">
  <h2 id="title1"></h2>
  <p id="text1"></p>
  <div id="timer1" class="timer">00:00.00</div>
  <button id="toQ1">Next</button>
</div>

<!-- QUESTION 1 -->
<div id="q1Page" class="section">
  <h2>Comprehension Question</h2>
  <p id="question1"></p>
  <textarea id="answer1"></textarea>
  <button id="toBreak">Next</button>
</div>

<!-- BREAK PAGE -->
<div id="breakPage" class="section">
  <h2>Break</h2>
  <p>Click next when you are ready to start the next passage.</p>
  <button id="nextToPassage2">Next</button>
</div>

<!-- PASSAGE 2 -->
<div id="passage2" class="section">
  <h2 id="title2"></h2>
  <p id="text2"></p>
  <div id="timer2" class="timer">00:00.00</div>
  <button id="toQ2">Next</button>
</div>

<!-- QUESTION 2 -->
<div id="q2Page" class="section">
  <h2>Comprehension Question</h2>
  <p id="question2"></p>
  <textarea id="answer2"></textarea>
  <button id="finishBtn">Finish</button>
</div>

<!-- RESULTS -->
<div id="results" class="section">
  <h2>Results</h2>
  <div class="result-box">
    <p><strong id="label1"></strong>: <span id="final1"></span></p>
    <p><strong>Your answer:</strong> <span id="finalAnswer1"></span></p>
    <br>
    <p><strong id="label2"></strong>: <span id="final2"></span></p>
    <p><strong>Your answer:</strong> <span id="finalAnswer2"></span></p>
  </div>

  <button id="submitResults">Submit Results</button>
  <p id="submitStatus" style="font-weight:bold;"></p>
</div>


<script>
/* -----------------------------
       PASSAGES + QUESTIONS
------------------------------ */

const PASSAGE_1 = 
`Digital reading habits have changed significantly ... nighttime use.

Despite these benefits, there is no universal agreement ... individual preferences.`;

const Q1 = `Why do some people prefer dark mode when reading at night?`;

const PASSAGE_2 =
`As digital content becomes more diverse, readers interact ... certain situations.

Dark mode reduces brightness ... overall usability.`;

const Q2 = `According to the passage, what is one drawback of using light mode for long periods?`;

/* -----------------------------
       RANDOMIZATION
------------------------------ */

let firstPassage, secondPassage;
let firstQ, secondQ;
let firstLine, secondLine;
let firstMode, secondMode;

function randomize() {
  const order = Math.random() < 0.5 ? 1 : 2;

  if (order === 1) {
    firstPassage = PASSAGE_1;
    firstQ = Q1;
    firstLine = PASSAGE_1.split("\n")[0];

    secondPassage = PASSAGE_2;
    secondQ = Q2;
    secondLine = PASSAGE_2.split("\n")[0];
  } else {
    firstPassage = PASSAGE_2;
    firstQ = Q2;
    firstLine = PASSAGE_2.split("\n")[0];

    secondPassage = PASSAGE_1;
    secondQ = Q1;
    secondLine = PASSAGE_1.split("\n")[0];
  }

  const lightFirst = Math.random() < 0.5;
  firstMode = lightFirst ? "light" : "dark";
  secondMode = lightFirst ? "dark" : "light";
}

/* -----------------------------
       TIMER UTIL
------------------------------ */

function formatTime(ms) {
  let s = ms / 1000;
  return (
    String(Math.floor(s / 60)).padStart(2, "0") + ":" +
    String(Math.floor(s % 60)).padStart(2, "0") + "." +
    String(Math.floor((s % 1) * 100)).padStart(2, "0")
  );
}

let start1, start2;
let interval1, interval2;

/* -----------------------------
       BEGIN STUDY
------------------------------ */

document.getElementById("beginBtn").addEventListener("click", () => {
  randomize();

  document.getElementById("text1").textContent = firstPassage;
  document.getElementById("question1").textContent = firstQ;

  document.getElementById("text2").textContent = secondPassage;
  document.getElementById("question2").textContent = secondQ;

  document.getElementById("title1").textContent =
    `${firstLine} — ${firstMode.toUpperCase()} MODE`;

  document.getElementById("title2").textContent =
    `${secondLine} — ${secondMode.toUpperCase()} MODE`;

  document.getElementById("label1").textContent =
    `${firstLine} (${firstMode} mode)`;

  document.getElementById("label2").textContent =
    `${secondLine} (${secondMode} mode)`;

  document.getElementById("startPage").classList.remove("visible");
  document.getElementById("passage1").classList.add("visible");

  document.body.classList.toggle("dark", firstMode === "dark");

  start1 = Date.now();
  interval1 = setInterval(() =>
    document.getElementById("timer1").textContent =
      formatTime(Date.now() - start1), 10);
});

/* -----------------------------
 PASSAGE 1 → QUESTION 1
------------------------------ */

document.getElementById("toQ1").addEventListener("click", () => {
  clearInterval(interval1);
  document.getElementById("final1").textContent =
    document.getElementById("timer1").textContent;

  document.getElementById("passage1").classList.remove("visible");
  document.getElementById("q1Page").classList.add("visible");
});

/* -----------------------------
 QUESTION 1 → BREAK PAGE
------------------------------ */

document.getElementById("toBreak").addEventListener("click", () => {
  document.getElementById("finalAnswer1").textContent =
    document.getElementById("answer1").value;

  document.getElementById("q1Page").classList.remove("visible");
  document.getElementById("breakPage").classList.add("visible");
});

/* -----------------------------
 BREAK → PASSAGE 2
------------------------------ */

document.getElementById("nextToPassage2").addEventListener("click", () => {
  document.getElementById("breakPage").classList.remove("visible");
  document.getElementById("passage2").classList.add("visible");

  document.body.classList.toggle("dark", secondMode === "dark");

  start2 = Date.now();
  interval2 = setInterval(() =>
    document.getElementById("timer2").textContent =
      formatTime(Date.now() - start2), 10);
});

/* -----------------------------
 PASSAGE 2 → QUESTION 2
------------------------------ */

document.getElementById("toQ2").addEventListener("click", () => {
  clearInterval(interval2);
  document.getElementById("final2").textContent =
    document.getElementById("timer2").textContent;

  document.getElementById("passage2").classList.remove("visible");
  document.getElementById("q2Page").classList.add("visible");
});

/* -----------------------------
 QUESTION 2 → RESULTS
------------------------------ */

document.getElementById("finishBtn").addEventListener("click", () => {
  document.getElementById("finalAnswer2").textContent =
    document.getElementById("answer2").value;

  document.getElementById("q2Page").classList.remove("visible");
  document.getElementById("results").classList.add("visible");
});

/* -----------------------------
      GOOGLE SHEETS SUBMISSION
------------------------------ */

document.getElementById("submitResults").addEventListener("click", () => {

  const data = {
    first_passage_first_line: firstLine,
    first_mode: firstMode,
    first_time: document.getElementById("final1").textContent,
    first_answer: document.getElementById("finalAnswer1").textContent,

    second_passage_first_line: secondLine,
    second_mode: secondMode,
    second_time: document.getElementById("final2").textContent,
    second_answer: document.getElementById("finalAnswer2").textContent
  };

  // *** THIS ONLY SENDS TO GOOGLE SHEETS — NO DOWNLOAD ***
  fetch("https://script.google.com/macros/s/AKfycby-9VjwPSyxya2vc0UuIx1HbM1LnEaM98bEGCVwHF3tWALSG6czbGBkAYt5jv8wSO-PcA/exec", {
    method: "POST",
    mode: "no-cors",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  });

  document.getElementById("submitStatus").textContent =
    "Submitted! You may close the window.";
});
</script>

</body>
</html>







